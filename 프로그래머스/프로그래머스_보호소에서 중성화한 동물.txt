-- 프로그래머스 SQL 문제풀이

-- 프로그래머스 > JOIN > 보호소에서 중성화한 동물
-- 링크 : https://programmers.co.kr/learn/courses/30/lessons/59045
-- 코드를 입력하세요
SELECT OUTS.ANIMAL_ID, OUTS.ANIMAL_TYPE, OUTS.NAME
FROM ANIMAL_INS INS
LEFT JOIN ANIMAL_OUTS OUTS 
ON INS.ANIMAL_ID = OUTS.ANIMAL_ID
-- 들어올 때 중성화안된 동물들 찾는 조건
WHERE (INS.SEX_UPON_INTAKE NOT LIKE '%SPAYED%' AND INS.SEX_UPON_INTAKE NOT LIKE '%NEUTERED%')
-- 중성화상태로 나간 동물들 찾는 조건을 결합(AND)
AND (OUTS.SEX_UPON_OUTCOME LIKE '%SPAYED%' OR OUTS.SEX_UPON_OUTCOME LIKE '%NEUTERED%')
ORDER BY ANIMAL_ID ASC